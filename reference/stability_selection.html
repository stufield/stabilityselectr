<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Stability Selection — stability_selection • stabilityselectr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Stability Selection — stability_selection"><meta name="description" content='Performs stability selection on a set of predictive features and a response
variable. Stability selection is performed using a user-specified kernel.
For classification problems the l1-logistic kernel should be used and the
response should be a vector or factor of with two class labels. For lasso
the response column should be a numeric vector. For "Cox" the response is a
two column matrix containing the event time in the first column and the
censoring indicator in the second column.
The randomized lasso is used if the alpha parameter is set to a value
less than 1. In a randomized Lasso the model coefficients are randomly
re-weighted when calculating the regularization term. This weighting can be
performed in two different ways. If Pw = NA then these random
weights are sampled uniformly between alpha and 1. If Pw is
supplied, then the random weights are chosen to be alpha with
probability Pw and 1 otherwise. The latter choice is used in Theorem
2 in Meinshausen and Buhlmann. Recommended values of alpha and
Pw are [0.5, 0.2].
The is_stab_sel() function checks whether
an object is class stab_sel. See inherits().'><meta property="og:description" content='Performs stability selection on a set of predictive features and a response
variable. Stability selection is performed using a user-specified kernel.
For classification problems the l1-logistic kernel should be used and the
response should be a vector or factor of with two class labels. For lasso
the response column should be a numeric vector. For "Cox" the response is a
two column matrix containing the event time in the first column and the
censoring indicator in the second column.
The randomized lasso is used if the alpha parameter is set to a value
less than 1. In a randomized Lasso the model coefficients are randomly
re-weighted when calculating the regularization term. This weighting can be
performed in two different ways. If Pw = NA then these random
weights are sampled uniformly between alpha and 1. If Pw is
supplied, then the random weights are chosen to be alpha with
probability Pw and 1 otherwise. The latter choice is used in Theorem
2 in Meinshausen and Buhlmann. Recommended values of alpha and
Pw are [0.5, 0.2].
The is_stab_sel() function checks whether
an object is class stab_sel. See inherits().'></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">stabilityselectr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/stabilityselectr.html">Get Started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/progeny-clustering.html">Progeny and Stability Clustering</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Stability Selection</h1>

      <div class="d-none name"><code>stability_selection.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs stability selection on a set of predictive features and a response
variable. Stability selection is performed using a user-specified kernel.
For classification problems the <code>l1-logistic</code> kernel should be used and the
response should be a vector or factor of with two class labels. For lasso
the response column should be a numeric vector. For "Cox" the response is a
<em>two column matrix</em> containing the event time in the first column and the
censoring indicator in the second column.
The randomized lasso is used if the <code>alpha</code> parameter is set to a value
less than 1. In a randomized Lasso the model coefficients are randomly
re-weighted when calculating the regularization term. This weighting can be
performed in two different ways. If <code>Pw = NA</code> then these random
weights are sampled uniformly between <code>alpha</code> and 1. If <code>Pw</code> is
supplied, then the random weights are chosen to be <code>alpha</code> with
probability <code>Pw</code> and 1 otherwise. The latter choice is used in Theorem
2 in Meinshausen and Buhlmann. Recommended values of <code>alpha</code> and
<code>Pw</code> are <code>[0.5, 0.2]</code>.</p>
<p>The <code>is_stab_sel()</code> function checks whether
an object is class <code>stab_sel</code>. See <code><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">stability_selection</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  kernel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"l1-logistic"</span>, <span class="st">"lasso"</span>, <span class="st">"ridge"</span>, <span class="st">"Cox"</span>, <span class="st">"pca.sd"</span>, <span class="st">"pca.thresh"</span>,</span>
<span>    <span class="st">"multinomial"</span><span class="op">)</span>,</span>
<span>  num_iter <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  Pw <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  num_perms <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  standardize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  lambda_min_ratio <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  beta_threshold <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  elastic_alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lambda_pad <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  impute_outliers <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  impute_n_sigma <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  r_seed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">is_stab_sel</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'stab_sel'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'stab_sel'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span>, <span class="va">thresh</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'stab_sel'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  thresh <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  custom_labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  main <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sort_by_AUC <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ln_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">col_palette</span><span class="op">)</span>,</span>
<span>  add_perm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  emp_thresh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.1</span>, by <span class="op">=</span> <span class="op">-</span><span class="fl">0.01</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A numeric \(n x p\) matrix of predictive features containing <code>n</code>
observation rows and <code>p</code> feature columns. Alternatively, a <code>stab_sel</code> class
object if passing to one of the S3 generic methods.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>The response variable. If kernel is "l1-logistic" then a
vector of binary class labels. If kernel is "Cox" then it is a two column
matrix with the event time in the first column and the censoring
indicator (1 = event, 0 = censored) in the second column.</p></dd>


<dt id="arg-kernel">kernel<a class="anchor" aria-label="anchor" href="#arg-kernel"></a></dt>
<dd><p><code>character(1)</code>. A string describing the underlying model
used for selection. Options are:</p><ul><li><p>"l1-logistic" (default)</p></li>
<li><p>"lasso"</p></li>
<li><p>"Cox"</p></li>
<li><p>"ridge"</p></li>
<li><p>"multinomial"</p></li>
<li><p>"pca.sd"</p></li>
<li><p>"pca.thresh"</p></li>
</ul></dd>


<dt id="arg-num-iter">num_iter<a class="anchor" aria-label="anchor" href="#arg-num-iter"></a></dt>
<dd><p><code>integer(1)</code>. Defining the number of
sub-sampling iterations for the stability selection.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p><code>logical(1)</code>. Should parallel processing
via multiple cores be implemented? Must be on a Linux
platform and have the <span class="pkg">parallel</span>
package installed. Otherwise defaults to 1 core.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p><code>numeric(1)</code>. Value defining the weakness
parameter for the randomized regularization.
This is the minimum random weight applied to each
beta coefficient in the regularization.</p></dd>


<dt id="arg-pw">Pw<a class="anchor" aria-label="anchor" href="#arg-pw"></a></dt>
<dd><p><code>numeric(1)</code>. Value defining probability of
a weak weight, see <code>alpha</code>. If <code>Pw = NA</code> then the
coefficient weights are sampled uniformly from <code>alpha</code> to 1.</p></dd>


<dt id="arg-num-perms">num_perms<a class="anchor" aria-label="anchor" href="#arg-num-perms"></a></dt>
<dd><p><code>integer(1)</code>. The number of permutations
to use in calculating the empirical false positive rate.</p></dd>


<dt id="arg-standardize">standardize<a class="anchor" aria-label="anchor" href="#arg-standardize"></a></dt>
<dd><p><code>logical(1)</code>. Whether the data should
be centered and scaled.</p></dd>


<dt id="arg-lambda-min-ratio">lambda_min_ratio<a class="anchor" aria-label="anchor" href="#arg-lambda-min-ratio"></a></dt>
<dd><p>The minimum value of
lambda/max(lambda) to use during
the selection procedure. See <code>glmnet()</code>.</p></dd>


<dt id="arg-beta-threshold">beta_threshold<a class="anchor" aria-label="anchor" href="#arg-beta-threshold"></a></dt>
<dd><p><code>numeric(1)</code>. Floating point value
defining selection levels for <code>ridge regression</code>.
Since ridge regression will not zero out coefficients,
selection of coefficient curves by selection probability
is not effective. Any variable having a coefficient with
absolute value greater than or equal to <code>beta_threshold</code>
will be selected.</p></dd>


<dt id="arg-elastic-alpha">elastic_alpha<a class="anchor" aria-label="anchor" href="#arg-elastic-alpha"></a></dt>
<dd><p><code>numeric(1)</code>. Floating point value
between 0 and 1. When 0, the results of <code>glmnet()</code> are
equivalent to Ridge regression.
When 1, the results are equivalent to Lasso.
Any value between 0 and 1 creates a compromise
between L1 and L2 penalty.</p></dd>


<dt id="arg-lambda-pad">lambda_pad<a class="anchor" aria-label="anchor" href="#arg-lambda-pad"></a></dt>
<dd><p>The lambda path is padded with high
values of lambda in order to produce a more appealing plot.
Occasionally, the degree of padding needs to be
adjusted in order to produce better resolution at low
values of lambda. Typical values for this parameter
are 20 (default), 15, 10, or 5.</p></dd>


<dt id="arg-impute-outliers">impute_outliers<a class="anchor" aria-label="anchor" href="#arg-impute-outliers"></a></dt>
<dd><p><code>logical(1)</code>. Should statistical
outliers (\(3 * \sigma\)) be imputed to approximate
a Gaussian distribution during stability selection?
See <code><a href="https://stufield.github.io/wranglr/reference/impute_outliers.html" class="external-link">wranglr::impute_outliers()</a></code>.</p></dd>


<dt id="arg-impute-n-sigma">impute_n_sigma<a class="anchor" aria-label="anchor" href="#arg-impute-n-sigma"></a></dt>
<dd><p><code>numeric(1)</code>. Standard deviation
outlier threshold for imputing outliers if
<code>impute_outliers = TRUE</code>, ignored otherwise.</p></dd>


<dt id="arg-r-seed">r_seed<a class="anchor" aria-label="anchor" href="#arg-r-seed"></a></dt>
<dd><p><code>integer(1)</code>. Seed for the random number
generator, allowing for reproducibility of results.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to one of the S3 methods for
<code>stab_sel</code> class objects, generics include:</p><ul><li><p><code>plot.stab_sel()</code></p></li>
<li><p><code>print.stab_sel()</code></p></li>
<li><p><code>summary.stab_sel()</code></p></li>
</ul></dd>


<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An <code>stab_sel</code> class object.</p></dd>


<dt id="arg-thresh">thresh<a class="anchor" aria-label="anchor" href="#arg-thresh"></a></dt>
<dd><p>A numeric minimum selection probability threshold.
This value can also be a vector of values in <code>[0, 1]</code>,
but ideally greater than 0.50.</p></dd>


<dt id="arg-custom-labels">custom_labels<a class="anchor" aria-label="anchor" href="#arg-custom-labels"></a></dt>
<dd><p><code>character(n)</code>. Character vector of additional
features to label in the plot, see <code>Details</code>.</p></dd>


<dt id="arg-main">main<a class="anchor" aria-label="anchor" href="#arg-main"></a></dt>
<dd><p><code>character(1)</code>. Optional plot title (default depends on kernel).</p></dd>


<dt id="arg-sort-by-auc">sort_by_AUC<a class="anchor" aria-label="anchor" href="#arg-sort-by-auc"></a></dt>
<dd><p><code>logical(1)</code>. If <code>TRUE</code>, entries in
the legend will be sorted by their curve AUC values
which are in parentheses following the variable name
in the legend.</p></dd>


<dt id="arg-ln-cols">ln_cols<a class="anchor" aria-label="anchor" href="#arg-ln-cols"></a></dt>
<dd><p><code>character(n)</code>. A vector of colors to be used as
line colors in plotting. Recycled as necessary.</p></dd>


<dt id="arg-add-perm">add_perm<a class="anchor" aria-label="anchor" href="#arg-add-perm"></a></dt>
<dd><p><code>logical(1)</code>. Should empirical false discovery lines
from the null permutation be added to the plot
(only if permutation was performed)? This can be time
consuming depending on the number of permutations.</p></dd>


<dt id="arg-emp-thresh">emp_thresh<a class="anchor" aria-label="anchor" href="#arg-emp-thresh"></a></dt>
<dd><p><code>numeric(n)</code>. A vector describing the empirical
threshold values to be used (<code>default = seq(1, 0.1, by = 0.01)</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>stab_sel</code> class object:</p>
<dl><dt>stabpath_matrix</dt>
<dd><p>A matrix of \(features x lambda_seq\) containing
stability selection probabilities. A row in this matrix corresponds to a
stability selection path for a single feature.</p></dd>

<dt>lambda</dt>
<dd><p>the sequence of lambdas used for regularization. They
correspond to the columns of <code>stabpath_matrix</code>.</p></dd>

<dt>alpha</dt>
<dd><p>the weakness parameter provided in the call.</p></dd>

<dt>Pw</dt>
<dd><p>the weak weight probability provided in the call.</p></dd>

<dt>kernel</dt>
<dd><p>the kernel used (e.g. l1-logistic).</p></dd>

<dt>num_iter</dt>
<dd><p>The number of iterations used in computing
the stability paths.</p></dd>

<dt>standardize</dt>
<dd><p>should the data be standardized prior to analysis?</p></dd>

<dt>lambda_min_ratio</dt>
<dd><p>?</p></dd>

<dt>perm_data</dt>
<dd><p>Logical. Is there permuted data to perform empirical FDR?</p></dd>

<dt>permpath_list</dt>
<dd><p>list containing information to calculated the
permutation paths of the empirical false positive rate.</p></dd>

<dt>perm_lambda</dt>
<dd><p>The lambda used in the permuted lists.</p></dd>

<dt>permpath_max</dt>
<dd><p>max lambda for the permuted lists (I think).</p></dd>

<dt>beta</dt>
<dd><p>A matrix of the betas calculated during the selection process.</p></dd>

<dt>r_seed</dt>
<dd><p>The random seed used.</p></dd>


</dl><p>The <code>is_stab_sel</code> function returns a logical boolean.</p>
<p>The S3 print method returns:</p>
<dl><dt>Stability Selection Kernel</dt>
<dd><p>The kernel used in the stability selection
algorithm.</p></dd>

<dt>Weakness</dt>
<dd><p>The weakness used (<code>alpha</code> argument).</p></dd>

<dt>Weakness Probability</dt>
<dd><p>The probability of the weakness being applied
(<code>Pw =</code> argument).</p></dd>

<dt>Number of Iterations</dt>
<dd><p>Number of iterations in the selection
(<code>num_iter =</code> argument).</p></dd>

<dt>Standardized</dt>
<dd><p>Was the data standardized prior to stability selection?</p></dd>

<dt>Imputed Outliers</dt>
<dd><p>Were statistical outliers imputed to the Gaussian
approximation prior to stability selection?</p></dd>

<dt>Lambda Max</dt>
<dd><p>The maximum lambda (tuning parameter) used.</p></dd>

<dt>Lambda Max</dt>
<dd><p>The maximum lambda (tuning parameter) used.</p></dd>

<dt>Random Seed</dt>
<dd><p>The seed passed to the random number generator
for subset selection.</p></dd>


</dl><p>A <code>ggplot</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Stability selection can be performed on multiple cores by setting
<code>parallel = TRUE</code>. This functionality requires
<code><a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">parallel::mclapply()</a></code> from the <span class="pkg">parallel</span> package.
This is <em>not</em> available for Windows based OS.</p>
    </div>
    <div class="section level2">
    <h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a></h2>

<ul><li><p><code>print(stab_sel)</code>: S3 <code>print</code> method for class <code>stab_sel</code>.</p></li>
<li><p><code>summary(stab_sel)</code>: The S3 <code>summary</code> method for class <code>stab_sel</code>.</p></li>
<li><p><code>plot(stab_sel)</code>: The S3 <code>plot</code> method plots the selection paths for the features. This
plot closely resembles a lasso coefficient plot with the regularization
parameter (lambda) plotted on x-axis and the feature selection probability
(rather than the model coefficient) is plotted on the y-axis.</p>
<p>Plots the regularization parameter (lambda) on the x-axis and the selection
probability on the y-axis. The regularization parameter is plotted as
lambda/max(lambda) so that it is in the range from 1 to 0. The selection
probability corresponds to the number of times a particular marker was
chosen at a given value of lambda. Each line in the plot is a marker and
represents the stability selection path over the range of regularization
parameter. All features that have a maximum selection probability greater
than <code>thresh</code> (shown as a dotted horizontal line) are colored and labeled
and the remaining features are colored gray and unlabeled. Additionally, you
can provide a set of custom labels that will be colored and labeled
regardless of their max selection probability. Each feature is labeled with
a capital letter and the full name of the feature is indicated in the legend
along with the AUC for its curve in parentheses.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Additional features can be passed as strings to the summary method
via the <code>add_features</code> argument.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Meinshausen, N. and Buhlmann, P. (2010), Stability selection.
Journal of the Royal Statistical Society: Series B (Statistical
Methodology), 72: 417-473. doi: 10.1111/j.1467-9868.2010.00740.x</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code>glmnet()</code>, <code><a href="get_stable_features.html">get_stable_features()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael R. Mehan, Stu Field, and Robert Kirk DeLisle</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># l1-logistic</span></span></span>
<span class="r-in"><span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html" class="external-link">with_seed</a></span><span class="op">(</span><span class="fl">101</span>, <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">n_feat</span>      <span class="op">&lt;-</span> <span class="fl">20</span></span></span>
<span class="r-in"><span>  <span class="va">n_samp</span>      <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>  <span class="va">x</span>           <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_samp</span> <span class="op">*</span> <span class="va">n_feat</span><span class="op">)</span>, <span class="va">n_samp</span>, <span class="va">n_feat</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"feat"</span>, <span class="st">"_"</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">letters</span>, <span class="va">n_feat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">y</span>           <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="va">n_samp</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">stab_sel</span>    <span class="op">&lt;-</span> <span class="fu">stability_selection</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, kernel <span class="op">=</span> <span class="st">"l1-logistic"</span>, r_seed <span class="op">=</span> <span class="fl">101</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✓</span> Using kernel: <span style="color: #0000BB;">'l1-logistic'</span> and <span style="color: #0000BB;">1</span> core (serial)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Cox</span></span></span>
<span class="r-in"><span><span class="va">xcox</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stufield.github.io/wranglr/reference/feature_matrix.html" class="external-link">feature_matrix</a></span><span class="op">(</span><span class="fu">stabilityselectr</span><span class="fu">:::</span><span class="fu">log_rfu</span><span class="op">(</span><span class="va">simdata</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note: this works because colnames are already "time" and "status".</span></span></span>
<span class="r-in"><span><span class="co">#   In 'real' datasets, you may need to rename the final matrix as</span></span></span>
<span class="r-in"><span><span class="co">#   "time" and "status".</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ycox</span> <span class="op">&lt;-</span> <span class="fu">select</span><span class="op">(</span><span class="va">simdata</span>, <span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">stab_sel_cox</span> <span class="op">&lt;-</span> <span class="fu">stability_selection</span><span class="op">(</span><span class="va">xcox</span>, <span class="va">ycox</span>, kernel <span class="op">=</span> <span class="st">"Cox"</span>, r_seed <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✓</span> Using kernel: <span style="color: #0000BB;">'Cox'</span> and <span style="color: #0000BB;">1</span> core (serial)</span>
<span class="r-in"><span><span class="co"># Test for class `stab_sel`</span></span></span>
<span class="r-in"><span><span class="fu">is_stab_sel</span><span class="op">(</span><span class="va">stab_sel</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># S3 print method</span></span></span>
<span class="r-in"><span><span class="va">stab_sel</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">══</span> Stability Selection (<span style="color: #00BBBB;">Kernel</span>: <span style="color: #00BB00;">l1-logistic</span>) <span style="color: #0000BB;">══════</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB0000;">•</span> Weakness (alpha)            <span style="color: #0000BB;">0.8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB0000;">•</span> Weakness Probability (Pw)   <span style="color: #0000BB;">0.5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB0000;">•</span> Number of Iterations        <span style="color: #0000BB;">100</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB0000;">•</span> Standardized                <span style="color: #0000BB;">'Yes'</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB0000;">•</span> Imputed Outliers            <span style="color: #0000BB;">'No'</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB0000;">•</span> Lambda Max                  <span style="color: #0000BB;">0.144</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB0000;">•</span> Lambda Min Ratio            <span style="color: #0000BB;">0.1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB0000;">•</span> Permuted Data               <span style="color: #0000BB;">'No'</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BB0000;">•</span> Random Seed                 <span style="color: #0000BB;">101</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">═══════════════════════════════════════════════════════════════════════</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># S3 summary method</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">stab_sel</span>, thresh <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 20 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    feature MaxSelectProb   AUC FDRbound</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> feat_d          0.945 0.422   0.012<span style="text-decoration: underline;">5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> feat_t          0.935 0.416   0.025 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> feat_a          0.915 0.342   0.037<span style="text-decoration: underline;">5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> feat_j          0.915 0.430   0.05  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> feat_s          0.905 0.343   0.062<span style="text-decoration: underline;">5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> feat_m          0.9   0.410   0.075 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> feat_l          0.89  0.326   0.087<span style="text-decoration: underline;">5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> feat_f          0.885 0.300   0.1   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> feat_q          0.88  0.290   0.113 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> feat_g          0.87  0.269   0.125 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> feat_e          0.86  0.283   0.138 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> feat_n          0.86  0.226   0.15  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span> feat_r          0.86  0.352   0.163 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">14</span> feat_c          0.855 0.326   0.175 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">15</span> feat_k          0.85  0.292   0.188 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">16</span> feat_b          0.845 0.275   0.2   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">17</span> feat_o          0.84  0.243   0.213 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">18</span> feat_h          0.835 0.274   0.225 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">19</span> feat_p          0.83  0.236   0.238 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">20</span> feat_i          0.785 0.242   0.25  </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">stab_sel</span>, thresh <span class="op">=</span> <span class="fl">0.8</span>, add_features <span class="op">=</span> <span class="st">"feat_c"</span><span class="op">)</span>   <span class="co"># force feat_c into table</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 19 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    feature MaxSelectProb   AUC FDRbound</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> feat_d          0.945 0.422  0.004<span style="text-decoration: underline;">17</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> feat_t          0.935 0.416  0.008<span style="text-decoration: underline;">33</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> feat_a          0.915 0.342  0.012<span style="text-decoration: underline;">5</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> feat_j          0.915 0.430  0.016<span style="text-decoration: underline;">7</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> feat_s          0.905 0.343  0.020<span style="text-decoration: underline;">8</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> feat_m          0.9   0.410  0.025  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> feat_l          0.89  0.326  0.029<span style="text-decoration: underline;">2</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> feat_f          0.885 0.300  0.033<span style="text-decoration: underline;">3</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> feat_q          0.88  0.290  0.037<span style="text-decoration: underline;">5</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> feat_g          0.87  0.269  0.041<span style="text-decoration: underline;">7</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> feat_e          0.86  0.283  0.045<span style="text-decoration: underline;">8</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> feat_n          0.86  0.226  0.05   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span> feat_r          0.86  0.352  0.054<span style="text-decoration: underline;">2</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">14</span> feat_c          0.855 0.326  0.058<span style="text-decoration: underline;">3</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">15</span> feat_k          0.85  0.292  0.062<span style="text-decoration: underline;">5</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">16</span> feat_b          0.845 0.275  0.066<span style="text-decoration: underline;">7</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">17</span> feat_o          0.84  0.243  0.070<span style="text-decoration: underline;">8</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">18</span> feat_h          0.835 0.274  0.075  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">19</span> feat_p          0.83  0.236  0.079<span style="text-decoration: underline;">2</span> </span>
<span class="r-in"><span><span class="co"># S3 plot method</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">stab_sel</span>, thresh <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stability_selection-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/stufield" class="external-link">Stu Field</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer></body></html>


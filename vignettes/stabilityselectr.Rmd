---
title: "Introduction to Stability Selection"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction to Stability Selection}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
library(stabilityselectr)
library(ggplot2)
knitr::opts_chunk$set(
  collapse = TRUE, comment = "#>"
)
set.seed(101)
```



The `stabilityselectr` package performs stability selection with a 
variety of kernels provided by the `glmnet` package, and provides 
simple tools for plotting and extracting selected features.
There is additional functionality designed to facilitate
various forms of permutation clustering analyses.


---------------


## Useful functions in `stabilityselectr`

* `stabilitySelection()`
* `is.stab_sel()`
* `getStableFeatures()`
* `getThresholdFeatures()`
* `calcEmpFDR()`
* `calcEmpFDRbreaks()`
* `plotEmpFDR()`
* `plotPermutedData()`
* `progenyCluster()`
* `stabilityCluster()`


---------------

## Examples

A typical stability selection analysis might be similar to the one below.

#### Run `stabilitySelection()`
```{r stab_sel}
set.seed(101)
n_feat      <- 20
n_samples   <- 100
x           <- matrix(rnorm(n_feat * n_samples), n_samples, n_feat)
colnames(x) <- paste0("feat", "_", head(letters, n_feat))
y           <- sample(1:2, n_samples, replace = TRUE)
stab_sel    <- stabilitySelection(x, y, kernel = "l1-logistic", num.iter = 500)
is.stab_sel(stab_sel)
stab_sel
```

#### Plot stability paths
```{r plot_stab_sel, fig.width = 8, fig.height = 6}
plot(stab_sel, thresh = 0.85)
```


#### Stable Features at threshold
```{r get_features}
getStableFeatures(stab_sel, thresh = 0.85)
```

#### Stable Features at multiple thresholds
```{r get_threshold}
getThresholdFeatures(stab_sel, thresh.vec = seq(0.7, 0.9, 0.05))
```


---------------


## Progeny and Stability Clustering

See separate vignette on clustering: `vignette("progeny-clustering")`.
